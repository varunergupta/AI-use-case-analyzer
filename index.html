<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>AI Agent Use Case Checker</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,300&family=DM+Mono:wght@400;500&display=swap');

  :root {
    --bg: #0a0e1a;
    --surface: #111827;
    --surface2: #1a2235;
    --border: rgba(255,255,255,0.08);
    --border-hover: rgba(99,179,237,0.4);
    --accent: #00d4aa;
    --accent2: #3b82f6;
    --accent3: #8b5cf6;
    --text: #e2e8f0;
    --text-muted: #64748b;
    --text-dim: #94a3b8;
    --green: #10b981;
    --yellow: #f59e0b;
    --red: #ef4444;
    --radius: 12px;
    --radius-sm: 8px;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse 800px 600px at 20% 10%, rgba(0,212,170,0.06) 0%, transparent 60%),
      radial-gradient(ellipse 600px 500px at 80% 80%, rgba(59,130,246,0.07) 0%, transparent 60%),
      radial-gradient(ellipse 400px 400px at 60% 30%, rgba(139,92,246,0.05) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  .container {
    max-width: 920px;
    margin: 0 auto;
    padding: 40px 24px 80px;
    position: relative;
    z-index: 1;
  }

  .header {
    display: flex;
    align-items: flex-start;
    gap: 16px;
    margin-bottom: 40px;
  }

  .header-icon {
    width: 52px;
    height: 52px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    flex-shrink: 0;
    box-shadow: 0 0 30px rgba(0,212,170,0.3);
  }

  .header-text h1 {
    font-size: 26px;
    font-weight: 600;
    letter-spacing: -0.5px;
    line-height: 1.2;
    background: linear-gradient(90deg, #e2e8f0 0%, var(--accent) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .header-text p {
    margin-top: 6px;
    color: var(--text-muted);
    font-size: 14px;
    font-weight: 300;
  }

  .source-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    margin-top: 8px;
    padding: 4px 10px;
    background: rgba(59,130,246,0.12);
    border: 1px solid rgba(59,130,246,0.25);
    border-radius: 20px;
    font-size: 11px;
    color: var(--accent2);
    font-family: 'DM Mono', monospace;
    text-decoration: none;
    transition: background 0.2s;
  }
  .source-badge:hover { background: rgba(59,130,246,0.2); }
  .source-badge::before { content: '‚¨°'; font-size: 10px; }

  .form-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 32px;
    margin-bottom: 28px;
  }

  .section-label {
    font-size: 11px;
    font-weight: 600;
    color: var(--text-muted);
    letter-spacing: 0.08em;
    text-transform: uppercase;
    margin-bottom: 24px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .section-label::before {
    content: '';
    display: block;
    width: 20px;
    height: 2px;
    background: var(--accent);
  }

  .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .form-group.full { grid-column: 1 / -1; }

  .label-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  label {
    font-size: 12px;
    font-weight: 500;
    color: var(--text-dim);
    letter-spacing: 0.04em;
    text-transform: uppercase;
  }

  .ai-fill-btn {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 3px 11px;
    background: rgba(139,92,246,0.15);
    border: 1px solid rgba(139,92,246,0.35);
    border-radius: 20px;
    font-size: 11px;
    font-weight: 500;
    color: #c4b5fd;
    cursor: pointer;
    font-family: 'DM Sans', sans-serif;
    transition: background 0.2s, transform 0.15s;
    white-space: nowrap;
  }
  .ai-fill-btn:hover:not(:disabled) {
    background: rgba(139,92,246,0.28);
    transform: translateY(-1px);
  }
  .ai-fill-btn:disabled { opacity: 0.45; cursor: not-allowed; }

  @keyframes fillGlow {
    0%   { box-shadow: 0 0 0 3px rgba(139,92,246,0.35); border-color: rgba(139,92,246,0.7); }
    100% { box-shadow: none; border-color: var(--border); }
  }
  .just-filled { animation: fillGlow 1.6s ease-out forwards; }

  select, input, textarea {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    padding: 12px 14px;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
    width: 100%;
    appearance: none;
    -webkit-appearance: none;
  }
  select {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2364748b' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 14px center;
    padding-right: 36px;
    cursor: pointer;
  }
  select option { background: #1a2235; }
  textarea { resize: vertical; min-height: 108px; line-height: 1.65; }
  select:focus, input:focus, textarea:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(0,212,170,0.1);
  }

  .submit-btn {
    margin-top: 24px;
    width: 100%;
    padding: 15px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border: none;
    border-radius: var(--radius-sm);
    color: #0a0e1a;
    font-family: 'DM Sans', sans-serif;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: opacity 0.2s, transform 0.1s, box-shadow 0.2s;
    box-shadow: 0 4px 20px rgba(0,212,170,0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }
  .submit-btn:hover:not(:disabled) {
    opacity: 0.92;
    transform: translateY(-1px);
    box-shadow: 0 6px 28px rgba(0,212,170,0.4);
  }
  .submit-btn:active:not(:disabled) { transform: translateY(0); }
  .submit-btn:disabled { opacity: 0.55; cursor: not-allowed; }

  .spinner {
    width: 17px; height: 17px;
    border: 2.5px solid rgba(10,14,26,0.25);
    border-top-color: #0a0e1a;
    border-radius: 50%;
    animation: spin 0.65s linear infinite;
    flex-shrink: 0;
  }
  .spinner-purple {
    width: 12px; height: 12px;
    border: 2px solid rgba(196,181,253,0.2);
    border-top-color: #c4b5fd;
    border-radius: 50%;
    animation: spin 0.65s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  .loading-wrap {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 52px 32px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 14px;
    text-align: center;
  }
  .loading-orb {
    width: 62px; height: 62px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 28px;
    animation: orbPulse 1.8s ease-in-out infinite;
  }
  @keyframes orbPulse {
    0%,100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0,212,170,0.4); }
    50%      { transform: scale(1.07); box-shadow: 0 0 0 20px rgba(0,212,170,0); }
  }
  .loading-title { font-size: 16px; font-weight: 500; color: var(--text); }
  .loading-steps { display: flex; flex-direction: column; gap: 8px; margin-top: 4px; }
  .loading-step {
    font-size: 12px;
    color: var(--text-muted);
    font-family: 'DM Mono', monospace;
    display: flex; align-items: center; gap: 8px;
    opacity: 0; transform: translateY(6px);
    transition: opacity 0.4s, transform 0.4s;
  }
  .loading-step.visible { opacity: 1; transform: none; }
  .step-dot {
    width: 6px; height: 6px;
    background: var(--accent);
    border-radius: 50%; flex-shrink: 0;
    animation: dotBlink 1s ease-in-out infinite;
  }
  @keyframes dotBlink { 0%,100%{opacity:1} 50%{opacity:0.3} }

  .results-container {
    display: flex; flex-direction: column; gap: 16px;
    animation: fadeUp 0.4s ease-out;
  }
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(14px); }
    to   { opacity: 1; transform: none; }
  }

  .results-header { display: flex; align-items: center; justify-content: space-between; }
  .results-title {
    font-size: 12px; font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase; letter-spacing: 0.08em;
    display: flex; align-items: center; gap: 8px;
  }
  .count-badge {
    background: rgba(0,212,170,0.15);
    color: var(--accent);
    border: 1px solid rgba(0,212,170,0.3);
    border-radius: 20px;
    padding: 2px 10px;
    font-size: 11px;
    font-family: 'DM Mono', monospace;
  }
  .clear-btn {
    font-size: 12px; color: var(--text-muted);
    background: none; border: 1px solid var(--border);
    border-radius: 6px; padding: 6px 13px;
    cursor: pointer; transition: color 0.2s, border-color 0.2s;
    font-family: 'DM Sans', sans-serif;
  }
  .clear-btn:hover { color: var(--text); border-color: rgba(255,255,255,0.2); }

  .summary-bar {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 18px 28px;
    display: flex; align-items: center; gap: 28px; flex-wrap: wrap;
  }
  .summary-item { display: flex; flex-direction: column; gap: 3px; }
  .summary-val { font-size: 24px; font-weight: 600; font-family: 'DM Mono', monospace; color: var(--accent); }
  .summary-key { font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.06em; }
  .summary-divider { width: 1px; height: 38px; background: var(--border); }

  .match-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    overflow: hidden;
    transition: border-color 0.2s, box-shadow 0.2s;
    animation: fadeUp 0.4s ease-out both;
  }
  .match-card:hover { border-color: var(--border-hover); box-shadow: 0 4px 24px rgba(0,0,0,0.3); }

  .match-card-header {
    padding: 22px 26px 18px;
    display: flex; align-items: flex-start; gap: 16px;
    border-bottom: 1px solid var(--border);
  }
  .match-icon {
    width: 46px; height: 46px;
    border-radius: 12px;
    display: flex; align-items: center; justify-content: center;
    font-size: 22px; flex-shrink: 0;
  }
  .match-icon.high   { background: rgba(16,185,129,0.14); }
  .match-icon.medium { background: rgba(245,158,11,0.14); }
  .match-icon.low    { background: rgba(139,92,246,0.14); }

  .match-info { flex: 1; min-width: 0; }
  .match-name { font-size: 17px; font-weight: 600; color: var(--text); margin-bottom: 4px; }
  .match-dept { font-size: 11.5px; color: var(--text-muted); font-family: 'DM Mono', monospace; }

  .match-score-wrap { display: flex; flex-direction: column; align-items: flex-end; gap: 3px; }
  .match-score { font-size: 26px; font-weight: 700; font-family: 'DM Mono', monospace; }
  .match-score.high   { color: var(--green); }
  .match-score.medium { color: var(--yellow); }
  .match-score.low    { color: var(--accent3); }
  .match-label { font-size: 10px; text-transform: uppercase; letter-spacing: 0.09em; color: var(--text-muted); }

  .score-bar-wrap {
    margin-top: 10px; height: 4px;
    background: rgba(255,255,255,0.06);
    border-radius: 2px; overflow: hidden; width: 80px;
  }
  .score-bar-fill { height: 100%; border-radius: 2px; transition: width 1s ease-out; }
  .score-bar-fill.high   { background: var(--green); }
  .score-bar-fill.medium { background: var(--yellow); }
  .score-bar-fill.low    { background: var(--accent3); }

  .match-card-body { padding: 22px 26px; }

  .agent-desc {
    font-size: 14px; color: var(--text-dim);
    line-height: 1.75; margin-bottom: 18px;
  }

  .match-details {
    background: var(--surface2);
    border-radius: var(--radius-sm);
    padding: 16px 18px;
    margin-bottom: 18px;
    border-left: 3px solid;
  }
  .match-details.high   { border-left-color: var(--green); }
  .match-details.medium { border-left-color: var(--yellow); }
  .match-details.low    { border-left-color: var(--accent3); }

  .match-details-title {
    font-size: 11px; font-weight: 600;
    text-transform: uppercase; letter-spacing: 0.08em;
    margin-bottom: 12px;
    display: flex; align-items: center; gap: 6px;
  }
  .match-details.high   .match-details-title { color: var(--green); }
  .match-details.medium .match-details-title { color: var(--yellow); }
  .match-details.low    .match-details-title { color: var(--accent3); }

  .match-details-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  .detail-item { display: flex; flex-direction: column; gap: 4px; }
  .detail-key { font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.06em; }
  .detail-val { font-size: 13px; color: var(--text-dim); line-height: 1.55; }

  .tags { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 18px; }
  .tag {
    padding: 4px 10px; border-radius: 20px;
    font-size: 11px; font-family: 'DM Mono', monospace; border: 1px solid;
  }
  .tag-capability { background: rgba(139,92,246,0.1); border-color: rgba(139,92,246,0.25); color: #c4b5fd; }
  .tag-matched    { background: rgba(16,185,129,0.1); border-color: rgba(16,185,129,0.25); color: #6ee7b7; }

  .recommendation {
    background: rgba(0,212,170,0.05);
    border: 1px solid rgba(0,212,170,0.18);
    border-radius: var(--radius-sm);
    padding: 18px 20px;
  }
  .rec-header {
    font-size: 11px; font-weight: 600;
    text-transform: uppercase; letter-spacing: 0.08em;
    color: var(--accent); margin-bottom: 8px;
    display: flex; align-items: center; gap: 6px;
  }
  .rec-header::before { content: '‚ñ∏'; }
  .rec-text { font-size: 13.5px; color: var(--text-dim); line-height: 1.75; }

  .gallery-link {
    display: inline-flex; align-items: center; gap: 5px;
    margin-top: 12px; font-size: 12px; color: var(--accent2);
    text-decoration: none; font-family: 'DM Mono', monospace;
    transition: color 0.2s;
  }
  .gallery-link:hover { color: var(--accent); text-decoration: underline; }
  .gallery-link::after { content: ' ‚Üí'; }

  .no-match-card {
    background: var(--surface);
    border: 1px solid rgba(139,92,246,0.2);
    border-radius: var(--radius);
    padding: 36px; text-align: center;
  }
  .no-match-icon { font-size: 42px; margin-bottom: 12px; }
  .no-match-title { font-size: 18px; font-weight: 600; margin-bottom: 8px; }
  .no-match-desc { font-size: 14px; color: var(--text-muted); line-height: 1.75; max-width: 480px; margin: 0 auto; }

  .error-bar {
    background: rgba(239,68,68,0.07);
    border: 1px solid rgba(239,68,68,0.2);
    border-radius: var(--radius-sm);
    padding: 14px 18px;
    font-size: 13px; color: #fca5a5; line-height: 1.6;
  }

  .divider { height: 1px; background: var(--border); margin: 4px 0 8px; }

  /* ‚îÄ‚îÄ API Key Banner ‚îÄ‚îÄ */
  .api-key-banner {
    background: linear-gradient(135deg, rgba(139,92,246,0.1), rgba(59,130,246,0.08));
    border: 1px solid rgba(139,92,246,0.25);
    border-radius: var(--radius);
    padding: 20px 24px;
    margin-bottom: 24px;
    display: flex;
    align-items: center;
    gap: 16px;
    flex-wrap: wrap;
  }
  .api-key-banner.unlocked {
    background: linear-gradient(135deg, rgba(16,185,129,0.08), rgba(0,212,170,0.06));
    border-color: rgba(16,185,129,0.25);
  }
  .api-key-icon {
    font-size: 22px;
    flex-shrink: 0;
  }
  .api-key-text { flex: 1; min-width: 180px; }
  .api-key-title {
    font-size: 13px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 3px;
  }
  .api-key-sub {
    font-size: 11.5px;
    color: var(--text-muted);
    line-height: 1.5;
  }
  .api-key-sub a { color: var(--accent2); text-decoration: none; }
  .api-key-sub a:hover { text-decoration: underline; }
  .api-key-input-wrap {
    display: flex;
    align-items: center;
    gap: 8px;
    flex: 2;
    min-width: 260px;
  }
  .api-key-input {
    flex: 1;
    background: rgba(10,14,26,0.6);
    border: 1px solid rgba(139,92,246,0.3);
    border-radius: var(--radius-sm);
    color: var(--text);
    font-family: 'DM Mono', monospace;
    font-size: 13px;
    padding: 10px 14px;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
    letter-spacing: 0.03em;
  }
  .api-key-input:focus {
    border-color: var(--accent3);
    box-shadow: 0 0 0 3px rgba(139,92,246,0.12);
  }
  .api-key-input.valid {
    border-color: var(--green);
    box-shadow: 0 0 0 3px rgba(16,185,129,0.1);
  }
  .api-key-save-btn {
    padding: 10px 18px;
    background: rgba(139,92,246,0.2);
    border: 1px solid rgba(139,92,246,0.4);
    border-radius: var(--radius-sm);
    color: #c4b5fd;
    font-family: 'DM Sans', sans-serif;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    white-space: nowrap;
    transition: background 0.2s, transform 0.1s;
  }
  .api-key-save-btn:hover { background: rgba(139,92,246,0.32); transform: translateY(-1px); }
  .api-key-save-btn.saved {
    background: rgba(16,185,129,0.15);
    border-color: rgba(16,185,129,0.3);
    color: #6ee7b7;
  }
  .api-key-status {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    font-family: 'DM Mono', monospace;
    white-space: nowrap;
  }
  .key-dot {
    width: 7px; height: 7px;
    border-radius: 50%; flex-shrink: 0;
  }
  .key-dot.set   { background: var(--green); box-shadow: 0 0 6px rgba(16,185,129,0.6); }
  .key-dot.unset { background: var(--text-muted); }

  /* ‚îÄ‚îÄ Site Header ‚îÄ‚îÄ */
  .site-header {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(10,14,26,0.85);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border-bottom: 1px solid var(--border);
  }
  .site-header-inner {
    max-width: 920px;
    margin: 0 auto;
    padding: 0 24px;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .site-header-brand {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .site-header-avatar {
    width: 32px;
    height: 32px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 13px;
    font-weight: 700;
    color: #0a0e1a;
    letter-spacing: -0.5px;
    flex-shrink: 0;
  }
  .site-header-name {
    font-size: 14px;
    font-weight: 600;
    color: var(--text);
    letter-spacing: -0.2px;
  }
  .site-header-role {
    font-size: 11px;
    color: var(--text-muted);
    font-family: 'DM Mono', monospace;
  }
  .site-header-badge {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 5px 12px;
    background: rgba(0,212,170,0.08);
    border: 1px solid rgba(0,212,170,0.2);
    border-radius: 20px;
    font-size: 11px;
    color: var(--accent);
    font-family: 'DM Mono', monospace;
  }
  .site-header-badge::before {
    content: '';
    width: 6px;
    height: 6px;
    background: var(--accent);
    border-radius: 50%;
    animation: dotBlink 2s ease-in-out infinite;
  }

  /* ‚îÄ‚îÄ API Key Banner ‚îÄ‚îÄ */
  .api-key-banner {
    display: flex;
    align-items: flex-start;
    gap: 14px;
    background: rgba(245,158,11,0.07);
    border: 1px solid rgba(245,158,11,0.25);
    border-radius: var(--radius);
    padding: 18px 22px;
    margin-bottom: 24px;
    flex-wrap: wrap;
  }
  .api-key-banner.key-set {
    background: rgba(16,185,129,0.06);
    border-color: rgba(16,185,129,0.25);
  }
  .api-key-icon { font-size: 22px; flex-shrink: 0; margin-top: 2px; }
  .api-key-text { flex: 1; min-width: 180px; }
  .api-key-title {
    font-size: 13px; font-weight: 600;
    color: var(--text); margin-bottom: 4px;
  }
  .api-key-sub {
    font-size: 12px; color: var(--text-muted); line-height: 1.6;
  }
  .api-key-sub a { color: var(--accent2); text-decoration: none; }
  .api-key-sub a:hover { text-decoration: underline; }
  .api-key-input-wrap {
    display: flex; align-items: center; gap: 8px;
    flex-wrap: wrap;
  }
  .api-key-input {
    width: 240px !important;
    padding: 9px 12px !important;
    font-size: 13px !important;
    font-family: 'DM Mono', monospace !important;
    background: var(--surface2) !important;
    border: 1px solid rgba(245,158,11,0.3) !important;
    border-radius: var(--radius-sm) !important;
    color: var(--text) !important;
  }
  .api-key-input:focus {
    border-color: var(--yellow) !important;
    box-shadow: 0 0 0 3px rgba(245,158,11,0.12) !important;
  }
  .api-key-banner.key-set .api-key-input {
    border-color: rgba(16,185,129,0.3) !important;
  }
  .api-key-save-btn {
    padding: 9px 16px;
    background: rgba(245,158,11,0.15);
    border: 1px solid rgba(245,158,11,0.35);
    border-radius: var(--radius-sm);
    color: var(--yellow);
    font-family: 'DM Sans', sans-serif;
    font-size: 13px; font-weight: 600;
    cursor: pointer;
    transition: background 0.2s;
    white-space: nowrap;
  }
  .api-key-save-btn:hover { background: rgba(245,158,11,0.25); }
  .api-key-status {
    display: flex; align-items: center; gap: 6px;
    font-size: 12px; white-space: nowrap;
    font-family: 'DM Mono', monospace;
  }
  .key-dot {
    width: 7px; height: 7px;
    border-radius: 50%; flex-shrink: 0;
  }
  .key-dot.unset { background: var(--text-muted); }
  .key-dot.set   { background: var(--green); box-shadow: 0 0 6px rgba(16,185,129,0.6); animation: dotBlink 2s ease-in-out infinite; }

  /* ‚îÄ‚îÄ Site Footer ‚îÄ‚îÄ */
  .site-footer {
    border-top: 1px solid var(--border);
    background: rgba(10,14,26,0.6);
    margin-top: 60px;
  }
  .site-footer-inner {
    max-width: 920px;
    margin: 0 auto;
    padding: 28px 24px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 20px;
    flex-wrap: wrap;
  }
  .footer-left {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .footer-avatar {
    width: 38px;
    height: 38px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: 700;
    color: #0a0e1a;
    flex-shrink: 0;
  }
  .footer-name {
    font-size: 14px;
    font-weight: 600;
    color: var(--text);
  }
  .footer-tagline {
    font-size: 12px;
    color: var(--text-muted);
    margin-top: 2px;
  }
  .footer-right {
    display: flex;
    align-items: center;
    gap: 16px;
  }
  .footer-pill {
    padding: 4px 12px;
    background: rgba(59,130,246,0.1);
    border: 1px solid rgba(59,130,246,0.2);
    border-radius: 20px;
    font-size: 11px;
    color: var(--accent2);
    font-family: 'DM Mono', monospace;
  }
  .footer-copy {
    font-size: 11px;
    color: var(--text-muted);
  }

  @media (max-width: 600px) {
    .form-grid { grid-template-columns: 1fr; }
    .form-group.full { grid-column: auto; }
    .match-details-grid { grid-template-columns: 1fr; }
    .summary-bar { gap: 16px; }
    .site-footer-inner { flex-direction: column; align-items: flex-start; gap: 16px; }
    .footer-right { flex-wrap: wrap; }
  }
</style>
</head>
<body>

<!-- Site Header -->
<header class="site-header">
  <div class="site-header-inner">
    <div class="site-header-brand">
      <div class="site-header-avatar">VG</div>
      <div>
        <div class="site-header-name">Varun Gupta</div>
        <div class="site-header-role">ServiceNow ¬∑ AI Solutions</div>
      </div>
    </div>
    <div class="site-header-badge">AI Agent Checker ¬∑ Live</div>
  </div>
</header>

<div class="container">

  <div class="header">
    <div class="header-icon">ü§ñ</div>
    <div class="header-text">
      <h1>AI Agent Use Case Checker</h1>
      <p>Describe your use case ‚Äî AI will fill the details and deep-match against ServiceNow's OOB AI Agent gallery</p>
      <a class="source-badge" href="https://applibrary.service-now.com/ai_gallery?type=use_case&view=department" target="_blank">
        applibrary.service-now.com/ai_gallery
      </a>
    </div>
  </div>

  <!-- API Key Banner -->
  <div class="api-key-banner" id="apiKeyBanner">
    <div class="api-key-icon">üîë</div>
    <div class="api-key-text">
      <div class="api-key-title">Anthropic API Key Required</div>
      <div class="api-key-sub">Needed for ‚ú® AI Fill and deep match analysis. Your key stays in your browser only ‚Äî never stored or sent anywhere else. <a href="https://console.anthropic.com/keys" target="_blank">Get a key ‚Üí</a></div>
    </div>
    <div class="api-key-input-wrap">
      <input
        type="password"
        class="api-key-input"
        id="apiKeyInput"
        placeholder="sk-ant-api03-..."
        oninput="onKeyInput()"
        onkeydown="if(event.key==='Enter') saveKey()"
        autocomplete="off"
        spellcheck="false"
      />
      <button class="api-key-save-btn" id="apiKeySaveBtn" onclick="saveKey()">Save</button>
      <div class="api-key-status" id="apiKeyStatus">
        <span class="key-dot unset" id="keyDot"></span>
        <span id="keyStatusText" style="color:var(--text-muted)">Not set</span>
      </div>
    </div>
  </div>

  <div class="form-card">
    <div class="section-label">Describe Your Use Case</div>
    <div class="form-grid">

      <div class="form-group">
        <label>Department</label>
        <select id="dept" onchange="onFormChange()">
          <option value="">‚Äî Select department ‚Äî</option>
          <option>HR</option>
          <option>IT</option>
          <option>Finance</option>
          <option>Customer Service</option>
          <option>Procurement</option>
          <option>Legal</option>
          <option>Sales</option>
          <option>Marketing</option>
          <option>Operations</option>
          <option>Security</option>
          <option>Facilities</option>
        </select>
      </div>

      <div class="form-group">
        <label>Process / Workflow</label>
        <input type="text" id="process" placeholder="e.g. Incident Management, Onboarding" oninput="onFormChange()" />
      </div>

      <div class="form-group full">
        <div class="label-row">
          <label>Goal / Problem to Solve</label>
          <button class="ai-fill-btn" id="aiFillBtn" onclick="aiFillGoal()" disabled>
            <span>‚ú®</span> AI Fill
          </button>
        </div>
        <textarea id="goal" placeholder="Describe what you want to automate or improve ‚Äî or pick a Department + Process and click ‚ú® AI Fill to generate this automatically."></textarea>
      </div>

      <div class="form-group">
        <label>Expected Outcome</label>
        <input type="text" id="outcome" placeholder="e.g. Reduce resolution time by 40%" />
      </div>

      <div class="form-group">
        <label>Users Impacted</label>
        <select id="users">
          <option value="">‚Äî Select scope ‚Äî</option>
          <option>Individual contributor</option>
          <option>Team (5‚Äì20 people)</option>
          <option>Department (50‚Äì200 people)</option>
          <option>Enterprise-wide</option>
          <option>External / Customer-facing</option>
        </select>
      </div>

    </div>
    <button class="submit-btn" id="submitBtn" onclick="runCheck()">
      <span id="btnText">Deep Check Against OOB AI Agents</span>
      <span id="btnIcon">‚ö°</span>
    </button>
  </div>

  <div id="output"></div>
</div>

<!-- Site Footer -->
<footer class="site-footer">
  <div class="site-footer-inner">
    <div class="footer-left">
      <div class="footer-avatar">VG</div>
      <div>
        <div class="footer-name">Varun Gupta</div>
        <div class="footer-tagline">Built with ServiceNow AI ¬∑ Powered by Claude</div>
      </div>
    </div>
    <div class="footer-right">
      <span class="footer-pill">ServiceNow AI Gallery</span>
      <span class="footer-copy">¬© 2026 Varun Gupta. All rights reserved.</span>
    </div>
  </div>
</footer>

<script>

// ‚îÄ‚îÄ API Key Management ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function getApiKey() {
  return sessionStorage.getItem('vg_anthropic_key') || '';
}

function onKeyInput() {
  const val = document.getElementById('apiKeyInput').value.trim();
  const btn = document.getElementById('apiKeySaveBtn');
  btn.classList.remove('saved');
  btn.textContent = 'Save';
}

function saveKey() {
  const val = document.getElementById('apiKeyInput').value.trim();
  if (!val) return;

  sessionStorage.setItem('vg_anthropic_key', val);

  const input   = document.getElementById('apiKeyInput');
  const btn     = document.getElementById('apiKeySaveBtn');
  const dot     = document.getElementById('keyDot');
  const status  = document.getElementById('keyStatusText');
  const banner  = document.getElementById('apiKeyBanner');

  input.classList.add('valid');
  btn.classList.add('saved');
  btn.textContent = '‚úì Saved';
  dot.className = 'key-dot set';
  status.textContent = 'Key active';
  status.style.color = 'var(--green)';
  banner.classList.add('unlocked');

  // Mask the key display
  setTimeout(() => {
    input.value = val.slice(0,8) + '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢' + val.slice(-4);
    input.style.color = 'var(--text-muted)';
  }, 600);
}

// On page load, restore key from session if present
window.addEventListener('DOMContentLoaded', () => {
  const saved = getApiKey();
  if (saved) {
    document.getElementById('apiKeyInput').value = saved.slice(0,8) + '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢' + saved.slice(-4);
    document.getElementById('apiKeyInput').style.color = 'var(--text-muted)';
    document.getElementById('apiKeyInput').classList.add('valid');
    document.getElementById('apiKeySaveBtn').classList.add('saved');
    document.getElementById('apiKeySaveBtn').textContent = '‚úì Saved';
    document.getElementById('keyDot').className = 'key-dot set';
    document.getElementById('keyStatusText').textContent = 'Key active';
    document.getElementById('keyStatusText').style.color = 'var(--green)';
    document.getElementById('apiKeyBanner').classList.add('unlocked');
  }
});

const OOB_AGENTS = [
  {
    name: "IT Help Desk Agent",
    dept: ["IT"],
    icon: "üñ•Ô∏è",
    capabilities: ["Auto-triage", "Smart routing", "Resolution suggestions", "Knowledge search", "SLA monitoring"],
    description: "Autonomously handles IT service desk inquiries end-to-end. Ingests tickets from email, chat, and portal, applies NLP to classify category and urgency, queries the knowledge base for resolution steps, and routes unsolved tickets to the right L2/L3 team. Tracks SLA breaches in real-time and sends proactive alerts. Can resolve up to 60% of common issues without human intervention.",
    useCases: [
      "Auto-triage and classify incoming IT incidents by priority and category",
      "Route tickets to the right support tier based on skills and availability",
      "Search knowledge base articles and suggest self-service resolutions",
      "Monitor SLA thresholds and escalate breaches proactively",
      "Send automated status updates to requesters"
    ]
  },
  {
    name: "HR Onboarding Agent",
    dept: ["HR"],
    icon: "üë•",
    capabilities: ["Task orchestration", "Checklist automation", "Cross-team coordination", "Status tracking", "Document collection"],
    description: "Manages the full new-hire onboarding lifecycle from offer acceptance to day-90 check-in. Automatically creates and assigns tasks across HR, IT, Facilities, and Payroll. Collects onboarding documents, tracks completion status, sends reminders, and surfaces blockers to HR managers. Handles offboarding workflows with the same orchestration logic in reverse.",
    useCases: [
      "Auto-create multi-department onboarding task plans on day-1",
      "Track document submission and send reminders for missing paperwork",
      "Coordinate IT provisioning, badge access, and workspace setup",
      "Run day-30/60/90 check-in surveys and flag disengagement signals",
      "Automate offboarding access revocation and asset return"
    ]
  },
  {
    name: "Procurement Request Agent",
    dept: ["Procurement", "Finance"],
    icon: "üì¶",
    capabilities: ["Request intake", "Approval routing", "Vendor matching", "Compliance checks", "PO generation"],
    description: "Digitizes and automates the procure-to-pay cycle. Accepts purchase requests via natural language, extracts line items, validates against budget thresholds and preferred vendor lists, routes for multi-tier approval, and generates POs on approval. Flags non-compliant spend, identifies duplicate requests, and provides real-time spend dashboards to procurement managers.",
    useCases: [
      "Intake purchase requests via chat and auto-extract line items",
      "Validate requests against budgets and preferred vendor catalogs",
      "Route requests through dynamic multi-level approval chains",
      "Auto-generate and dispatch purchase orders on final approval",
      "Flag policy violations and duplicate spend requests"
    ]
  },
  {
    name: "Customer Service Resolution Agent",
    dept: ["Customer Service"],
    icon: "üéß",
    capabilities: ["Case summarization", "Sentiment analysis", "Resolution recommendations", "Escalation detection", "CSAT prediction"],
    description: "Handles inbound customer service cases across email, chat, and voice channels. Summarizes case context for agents, analyzes customer sentiment in real-time, recommends resolution steps from a solutions library, and predicts escalation risk. Automates routine cases like order status checks and refund processing. Includes CSAT prediction to flag at-risk interactions before they escalate.",
    useCases: [
      "Auto-summarize customer case history for agents on case open",
      "Detect negative sentiment and flag escalation risk in real-time",
      "Recommend resolution steps from the solutions knowledge base",
      "Automate refunds, order status replies, and FAQ responses",
      "Predict CSAT score and trigger proactive intervention workflows"
    ]
  },
  {
    name: "Security Operations Agent",
    dept: ["Security", "IT"],
    icon: "üîê",
    capabilities: ["Alert triage", "Threat intelligence lookup", "Playbook execution", "Risk scoring", "SOAR integration"],
    description: "Augments SOC teams by automating the alert-to-resolution pipeline. Ingests alerts from SIEM tools, enriches them with threat intelligence feeds, calculates risk scores, and executes response playbooks for known threat patterns. Reduces MTTR by automating containment actions like blocking IPs or isolating endpoints. Escalates novel threats to human analysts with full enriched context.",
    useCases: [
      "Ingest SIEM alerts and enrich with threat intelligence automatically",
      "Score and prioritize security incidents by risk level",
      "Execute automated response playbooks for known threat patterns",
      "Contain threats by blocking IPs or isolating endpoints autonomously",
      "Escalate novel or high-severity threats with full context to analysts"
    ]
  },
  {
    name: "Finance Reconciliation Agent",
    dept: ["Finance"],
    icon: "üí∞",
    capabilities: ["Data extraction", "Anomaly detection", "Auto-reconciliation", "Audit trail", "Journal entry automation"],
    description: "Automates the financial close process by reconciling transactions across systems. Extracts data from ERP, banking, and AP/AR platforms, identifies discrepancies using rule-based and ML anomaly detection, and auto-posts matching journal entries. Provides drill-down audit trails for every reconciled item and alerts finance controllers to exceptions. Reduces close cycle time by up to 70%.",
    useCases: [
      "Extract and match transactions across ERP and bank statements",
      "Detect anomalies and flag discrepancies for controller review",
      "Auto-post journal entries for matched reconciliation items",
      "Generate audit-ready reconciliation reports with drill-down trails",
      "Track month-end close task progress across the finance team"
    ]
  },
  {
    name: "Change Management Agent",
    dept: ["IT", "Operations"],
    icon: "üîÑ",
    capabilities: ["Impact analysis", "Risk assessment", "CAB scheduling", "Rollback planning", "Conflict detection"],
    description: "Streamlines the IT change management lifecycle from request to post-implementation review. Automatically assesses change impact on CIs and services using CMDB data, assigns risk scores, detects scheduling conflicts, and prepares CAB agendas. Monitors changes during implementation, triggers rollback workflows on anomaly detection, and conducts automated PIRs.",
    useCases: [
      "Auto-assess change impact on CIs and services using CMDB",
      "Score risk and detect conflicts with other scheduled changes",
      "Build and distribute CAB agenda with pre-populated impact data",
      "Monitor change implementation and trigger rollback if health degrades",
      "Automate post-implementation review (PIR) data collection"
    ]
  },
  {
    name: "Legal Contract Review Agent",
    dept: ["Legal"],
    icon: "‚öñÔ∏è",
    capabilities: ["Contract extraction", "Clause analysis", "Risk flagging", "Redline suggestions", "Obligation tracking"],
    description: "Accelerates contract review cycles for legal teams. Ingests contracts in PDF or DOCX format, extracts key metadata, identifies non-standard or missing clauses against playbook templates, flags risk areas, and suggests redlines. Tracks obligations and renewal dates post-execution with proactive deadline alerts. Reduces average contract review time from days to hours.",
    useCases: [
      "Extract contract metadata: parties, dates, values, and terms",
      "Compare clauses against approved legal playbook templates",
      "Flag non-standard, missing, or high-risk clauses automatically",
      "Suggest redlines and negotiation guidance on flagged clauses",
      "Track post-signature obligations and send renewal deadline alerts"
    ]
  },
  {
    name: "Asset Lifecycle Agent",
    dept: ["IT", "Facilities", "Operations"],
    icon: "üóÉÔ∏è",
    capabilities: ["Asset tracking", "Lifecycle alerts", "Cost optimization", "Compliance reporting", "Refresh planning"],
    description: "Provides complete visibility and automation across IT and physical asset lifecycles. Discovers and tracks hardware and software assets, monitors warranty and license expiration dates, generates refresh recommendations based on age and TCO data, and automates disposal workflows including data wiping and vendor returns. Ensures license compliance by reconciling software deployments against entitlements in real-time.",
    useCases: [
      "Discover and maintain a real-time hardware and software asset inventory",
      "Alert on warranty expiry, license renewals, and end-of-life dates",
      "Generate refresh plans ranked by age, cost, and business criticality",
      "Automate asset retirement: data wipe requests and vendor return logistics",
      "Reconcile software deployments vs license entitlements for compliance"
    ]
  },
  {
    name: "Employee Self-Service Agent",
    dept: ["HR", "IT", "Finance"],
    icon: "üôã",
    capabilities: ["Natural language Q&A", "Policy lookup", "Form automation", "Status tracking", "Multi-department routing"],
    description: "Serves as a unified AI assistant for employees across HR, IT, and Finance domains. Answers natural language questions about policies, benefits, leave balances, payroll, and IT access by searching authoritative knowledge sources. Auto-populates and submits service request forms on behalf of employees, tracks status across departments, and deflects up to 50% of tier-1 queries without human involvement.",
    useCases: [
      "Answer policy and benefits questions in natural language 24/7",
      "Check leave balances, payroll info, and expense claim status",
      "Auto-fill and submit service requests on behalf of employees",
      "Track multi-department request status from a single interface",
      "Escalate unresolved questions to the right department seamlessly"
    ]
  },
  {
    name: "Field Service Management Agent",
    dept: ["Operations", "Facilities", "Customer Service"],
    icon: "üîß",
    capabilities: ["Work order dispatch", "Technician scheduling", "Parts inventory check", "SLA tracking", "Mobile updates"],
    description: "Optimizes field service operations by intelligently scheduling and dispatching work orders. Matches work orders to best-fit technicians based on skills, location, and availability. Checks parts inventory before dispatch, routes efficiently, and provides real-time status updates to customers. Escalates SLA-at-risk jobs proactively and captures job completion data for continuous improvement.",
    useCases: [
      "Auto-assign work orders to technicians based on skill and proximity",
      "Check parts and inventory availability before dispatching",
      "Send real-time status updates to customers via SMS or email",
      "Flag work orders at risk of breaching SLA and re-prioritize",
      "Capture job completion notes and drive CSAT follow-up surveys"
    ]
  },
  {
    name: "IT Operations (AIOps) Agent",
    dept: ["IT", "Operations"],
    icon: "üì°",
    capabilities: ["Event correlation", "Root cause analysis", "Anomaly detection", "Auto-remediation", "Capacity forecasting"],
    description: "Applies AI to IT operations to reduce noise and accelerate resolution. Ingests events from monitoring tools, correlates related alerts into unified incidents, identifies probable root causes using topology maps, and triggers auto-remediation for known patterns. Predicts capacity issues and infrastructure anomalies before they impact services, enabling proactive rather than reactive operations.",
    useCases: [
      "Correlate thousands of monitoring events into actionable incidents",
      "Identify root cause using topology and dependency mapping",
      "Auto-remediate known issues with approved runbook scripts",
      "Detect performance anomalies before users report them",
      "Forecast capacity and infrastructure bottlenecks proactively"
    ]
  }
];

let isAiFilling = false;
let isChecking  = false;

function onFormChange() {
  const dept = document.getElementById('dept').value;
  const proc = document.getElementById('process').value.trim();
  document.getElementById('aiFillBtn').disabled = !(dept || proc);
}

// ‚îÄ‚îÄ AI Fast-Fill ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function aiFillGoal() {
  if (isAiFilling) return;
  const dept = document.getElementById('dept').value;
  const proc = document.getElementById('process').value.trim();
  if (!dept && !proc) return;

  if (!getApiKey()) {
    const input = document.getElementById('apiKeyInput');
    input.focus();
    input.style.borderColor = 'var(--red)';
    input.placeholder = 'Please enter your API key first!';
    setTimeout(() => {
      input.style.borderColor = '';
      input.placeholder = 'sk-ant-api03-...';
    }, 2500);
    return;
  }

  isAiFilling = true;
  const btn = document.getElementById('aiFillBtn');
  btn.disabled = true;
  btn.innerHTML = '<div class="spinner-purple"></div> Generating...';

  const prompt = `You are helping a ServiceNow user describe an AI automation use case.

Department: ${dept || 'Not specified'}
Process / Workflow: ${proc || 'Not specified'}

Generate specific, realistic content for this use case form. Respond ONLY with valid JSON ‚Äî no preamble, no markdown fences.

{
  "goal": "2-3 sentences describing the automation goal and specific problem being solved. Be concrete and practical for ${dept || 'this department'} and ${proc || 'this process'}.",
  "outcome": "One concise expected business outcome with a quantified metric where possible."
}`;

  try {
    const res = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: { "Content-Type": "application/json", "x-api-key": getApiKey(), "anthropic-version": "2023-06-01", "anthropic-dangerous-direct-browser-access": "true" },
      body: JSON.stringify({
        model: "claude-sonnet-4-20250514",
        max_tokens: 1000,
        messages: [{ role: "user", content: prompt }]
      })
    });
    const data = await res.json();
    const raw  = data.content?.[0]?.text || '{}';
    const parsed = JSON.parse(raw.replace(/```json|```/g,'').trim());

    if (parsed.goal) await typewriterFill(document.getElementById('goal'), parsed.goal);
    if (parsed.outcome) {
      const el = document.getElementById('outcome');
      el.value = parsed.outcome;
      el.classList.add('just-filled');
      setTimeout(() => el.classList.remove('just-filled'), 1600);
    }
  } catch(e) {
    console.warn('AI fill failed:', e);
  }

  isAiFilling = false;
  btn.disabled = false;
  btn.innerHTML = '<span>‚ú®</span> AI Fill';
}

async function typewriterFill(el, text) {
  el.value = '';
  el.classList.add('just-filled');
  for (let i = 0; i < text.length; i++) {
    el.value += text[i];
    await new Promise(r => setTimeout(r, 11));
  }
  setTimeout(() => el.classList.remove('just-filled'), 1600);
}

// ‚îÄ‚îÄ Deep AI Check ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function runCheck() {
  if (isChecking) return;
  const dept    = document.getElementById('dept').value;
  const process = document.getElementById('process').value.trim();
  const goal    = document.getElementById('goal').value.trim();
  const outcome = document.getElementById('outcome').value.trim();
  const users   = document.getElementById('users').value;

  if (!dept && !process && !goal) {
    document.getElementById('output').innerHTML = `<div class="error-bar">Please fill in at least Department, Process, or Goal to continue.</div>`;
    return;
  }

  isChecking = true;
  setSubmitLoading(true);

  const output = document.getElementById('output');
  output.innerHTML = `
    <div class="loading-wrap">
      <div class="loading-orb">üîç</div>
      <div class="loading-title">Running deep AI analysis...</div>
      <div class="loading-steps">
        <div class="loading-step" id="step1"><span class="step-dot"></span>Reading all OOB agent descriptions</div>
        <div class="loading-step" id="step2"><span class="step-dot"></span>Semantically scoring each agent against your use case</div>
        <div class="loading-step" id="step3"><span class="step-dot"></span>Generating match rationale & per-agent recommendations</div>
      </div>
    </div>`;

  setTimeout(() => document.getElementById('step1')?.classList.add('visible'), 150);
  setTimeout(() => document.getElementById('step2')?.classList.add('visible'), 850);
  setTimeout(() => document.getElementById('step3')?.classList.add('visible'), 1700);

  try {
    const results = await deepCheck(dept, process, goal, outcome, users);
    renderResults(results);
  } catch(e) {
    console.error(e);
    output.innerHTML = `<div class="error-bar">AI analysis failed. Please try again.<br><small style="opacity:0.6">${e.message}</small></div>`;
  }

  isChecking = false;
  setSubmitLoading(false);
}

async function deepCheck(dept, process, goal, outcome, users) {
  const agentLib = OOB_AGENTS.map((a, i) =>
    `AGENT_${i} ‚Äî ${a.name}
  Departments: ${a.dept.join(', ')}
  Full Description: ${a.description}
  Supported Use Cases: ${a.useCases.map((u,j) => `[UC${j}] ${u}`).join(' | ')}
  Capabilities: ${a.capabilities.join(', ')}`
  ).join('\n\n');

  const prompt = `You are a senior ServiceNow solution architect evaluating a customer's AI automation use case against available OOB AI agents.

CUSTOMER USE CASE:
- Department: ${dept || 'Not specified'}
- Process/Workflow: ${process || 'Not specified'}
- Goal/Problem: ${goal || 'Not specified'}
- Expected Outcome: ${outcome || 'Not specified'}
- Users Impacted: ${users || 'Not specified'}

SERVICENOW OOB AI AGENT LIBRARY:
${agentLib}

TASK: Perform a deep semantic analysis. Read each agent's full description and use case list carefully. For each agent that has ANY relevant overlap, provide a thorough scoring and rationale.

Return ONLY a valid JSON array (no markdown, no preamble):
[
  {
    "agentIndex": <number matching AGENT_N>,
    "score": <0-100>,
    "matchLevel": "high" | "medium" | "low",
    "matchedUseCases": ["exact or closely paraphrased use cases from the agent that map to this submission"],
    "coverageRationale": "2-3 sentences. Be specific: name exact capabilities, how they address the submitted goal, and where they'd be applied in this use case.",
    "gaps": "What this agent does NOT cover from the submission, or null if fully covered.",
    "configNote": "Specific ServiceNow configuration, workflow customization, or integration needed to implement this for the submitted use case."
  }
]

Scoring guide:
- 75-100 (high): Direct, primary match ‚Äî agent was designed for exactly this
- 40-74 (medium): Strong adjacent match ‚Äî agent covers core elements but not all aspects
- 10-39 (low): Tangential or partial overlap ‚Äî worth noting but not a primary fit
- 0: Skip entirely

Rules:
- Return max 5 results, sorted by score descending
- Only include score >= 10
- Be insightful and specific in coverageRationale ‚Äî generic responses are not acceptable
- matchedUseCases must reference actual use cases from the agent library above
- If nothing scores >= 10, return []`;

  const apiKey = getApiKey();
  if (!apiKey) throw new Error("No API key set. Please enter your Anthropic API key above.");

  const res = await fetch("https://api.anthropic.com/v1/messages", {
    method: "POST",
    headers: { "Content-Type": "application/json", "x-api-key": apiKey, "anthropic-version": "2023-06-01", "anthropic-dangerous-direct-browser-access": "true" },
    body: JSON.stringify({
      model: "claude-sonnet-4-20250514",
      max_tokens: 1000,
      messages: [{ role: "user", content: prompt }]
    })
  });

  if (!res.ok) throw new Error(`API returned ${res.status}. Check your API key is valid.`);
  const data = await res.json();
  const raw  = data.content?.[0]?.text || '[]';
  return JSON.parse(raw.replace(/```json|```/g,'').trim());
}

function renderResults(results) {
  const output = document.getElementById('output');

  if (!results || results.length === 0) {
    output.innerHTML = `
      <div class="no-match-card">
        <div class="no-match-icon">üî≠</div>
        <div class="no-match-title">No OOB Match Found</div>
        <div class="no-match-desc">
          After deep analysis, your use case doesn't align closely with any current ServiceNow OOB AI agents.
          This may be a strong custom-build opportunity or a candidate for combining multiple agents into an orchestrated workflow.
          <br><br>
          <a href="https://applibrary.service-now.com/ai_gallery?type=use_case&view=department" target="_blank" style="color:var(--accent2)">Browse the full ServiceNow AI Gallery ‚Üí</a>
        </div>
      </div>`;
    return;
  }

  const highCount = results.filter(r => r.matchLevel === 'high').length;
  const topScore  = results[0]?.score || 0;

  const summaryHTML = `
    <div class="summary-bar">
      <div class="summary-item">
        <span class="summary-val">${results.length}</span>
        <span class="summary-key">Agents Matched</span>
      </div>
      <div class="summary-divider"></div>
      <div class="summary-item">
        <span class="summary-val" style="color:var(--green)">${highCount}</span>
        <span class="summary-key">Strong Matches</span>
      </div>
      <div class="summary-divider"></div>
      <div class="summary-item">
        <span class="summary-val" style="color:var(--accent2)">${topScore}%</span>
        <span class="summary-key">Top Score</span>
      </div>
    </div>`;

  const labelMap = { high: 'Strong Match', medium: 'Partial Match', low: 'Exploratory' };

  const cardsHTML = results.map((r, idx) => {
    const agent = OOB_AGENTS[r.agentIndex];
    if (!agent) return '';
    const level = r.matchLevel || 'low';

    return `
      <div class="match-card" style="animation-delay:${idx * 90}ms">
        <div class="match-card-header">
          <div class="match-icon ${level}">${agent.icon}</div>
          <div class="match-info">
            <div class="match-name">${agent.name}</div>
            <div class="match-dept">${agent.dept.join(' ¬∑ ')}</div>
          </div>
          <div class="match-score-wrap">
            <div class="match-score ${level}">${r.score}%</div>
            <div class="match-label">${labelMap[level]}</div>
            <div class="score-bar-wrap">
              <div class="score-bar-fill ${level}" style="width:${r.score}%"></div>
            </div>
          </div>
        </div>

        <div class="match-card-body">
          <div class="agent-desc">${agent.description}</div>

          <div class="match-details ${level}">
            <div class="match-details-title">üéØ Match Analysis for Your Use Case</div>
            <div class="match-details-grid">

              <div class="detail-item" style="grid-column:1/-1">
                <div class="detail-key">Coverage Rationale</div>
                <div class="detail-val">${r.coverageRationale}</div>
              </div>

              ${r.matchedUseCases?.length ? `
              <div class="detail-item" style="grid-column:1/-1">
                <div class="detail-key">Matching Use Cases in this Agent</div>
                <div style="display:flex;flex-wrap:wrap;gap:6px;margin-top:5px">
                  ${r.matchedUseCases.map(uc => `<span class="tag tag-matched">${uc}</span>`).join('')}
                </div>
              </div>` : ''}

              ${r.gaps ? `
              <div class="detail-item">
                <div class="detail-key">Gaps / Not Covered</div>
                <div class="detail-val" style="color:#fca5a5">${r.gaps}</div>
              </div>` : `
              <div class="detail-item">
                <div class="detail-key">Coverage</div>
                <div class="detail-val" style="color:#6ee7b7">Fully covered by this agent</div>
              </div>`}

              ${r.configNote ? `
              <div class="detail-item">
                <div class="detail-key">Config / Customization Needed</div>
                <div class="detail-val">${r.configNote}</div>
              </div>` : ''}

            </div>
          </div>

          <div class="tags">
            ${agent.capabilities.map(c => `<span class="tag tag-capability">${c}</span>`).join('')}
          </div>

          ${idx === 0 ? `
          <div class="recommendation">
            <div class="rec-header">Top Recommendation</div>
            <div class="rec-text">
              Start with <strong style="color:var(--text)">${agent.name}</strong> ‚Äî it scored ${r.score}% and is your best OOB fit.
              ${r.coverageRationale}
              ${r.configNote ? `<br><br><span style="color:var(--text-muted);font-style:italic">Next step: ${r.configNote}</span>` : ''}
            </div>
            <a class="gallery-link" href="https://applibrary.service-now.com/ai_gallery?type=use_case&view=department" target="_blank">View in ServiceNow AI Gallery</a>
          </div>` : `
          <a class="gallery-link" href="https://applibrary.service-now.com/ai_gallery?type=use_case&view=department" target="_blank">View in ServiceNow AI Gallery</a>`}

        </div>
      </div>`;
  }).join('');

  output.innerHTML = `
    <div class="results-container">
      <div class="results-header">
        <span class="results-title">OOB Agent Matches <span class="count-badge">${results.length} found</span></span>
        <button class="clear-btn" onclick="clearResults()">‚Ü∫ New Search</button>
      </div>
      ${summaryHTML}
      <div class="divider"></div>
      ${cardsHTML}
    </div>`;
}

function setSubmitLoading(on) {
  const btn  = document.getElementById('submitBtn');
  const text = document.getElementById('btnText');
  const icon = document.getElementById('btnIcon');
  btn.disabled = on;
  if (on) {
    text.textContent = 'Running Deep AI Analysis...';
    icon.innerHTML = '<div class="spinner"></div>';
  } else {
    text.textContent = 'Deep Check Against OOB AI Agents';
    icon.textContent = '‚ö°';
  }
}

function clearResults() {
  document.getElementById('output').innerHTML = '';
  ['dept','process','goal','outcome','users'].forEach(id => {
    const el = document.getElementById(id);
    if (el) el.value = '';
  });
  document.getElementById('aiFillBtn').disabled = true;
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>
</body>
</html>
